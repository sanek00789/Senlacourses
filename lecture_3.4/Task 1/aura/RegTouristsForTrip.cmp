<aura:component implements="flexipage:availableForRecordHome,force:hasRecordId" access="global" controller="RegTouristsForTripController">	
    <aura:attribute name="recordId" type="Id" access="public"/>
    <aura:attribute name="tourists" type="Tourist__c[]" access="public"/>
    <aura:attribute name="touristColumns" type="List" access="public"/>
    <aura:attribute name="Trip__c" type="Trip__c" access="public"/>    
    <aura:attribute name="selectedTouristsIds" type="Id[]" access="public"/>    
    <aura:attribute name="today" type="Date" access="public"/>
    <aura:attribute name="showModal" type="Boolean" default="false" access="public"/>
    <aura:attribute name="showSpinner" type="Boolean" access="public"/>
    <aura:attribute name="closeService" type="Boolean" access="public"/>
    <aura:attribute name="openService" type="Boolean" default="true" access="public"/>
    <aura:attribute name="record" type="Object" access="public"/>
    <aura:attribute name="simpleRecord" type="Object" access="public"/>
    <aura:attribute name="recordError" type="String" access="public"/>
    <aura:attribute name="title" type="String" default="{!$Label.c.Confirmation}" access="public"/>
    <aura:attribute name="message" type="String" default="{!$Label.c.confirmationFlightCreation}" access="public"/>
    
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>    
    <aura:handler event="aura:waiting" action="{!c.showSpinner}"/>
    <aura:handler event="aura:doneWaiting" action="{!c.hideSpinner}"/>
    <aura:handler name="clickYes" event="c:ConfirmationWindowClickYes" action="{!c.handleYes}"/>
    <aura:handler name="clickNo" event="c:ConfirmationWindowClickNo" action="{!c.handleNo}"/>
    
    <force:recordData aura:id="recordLoader"
                      fields="Name,Minimum_Age__c,Number_Free_Seats__c,Start_Date__c"
                      recordId="{!v.recordId}"
                      targetFields="{!v.simpleRecord}"
                      targetError="{!v.recordError}"
                      recordUpdated = "{! c.componentUpdate}"                       
                      />
    
    <lightning:layout> 
        <lightning:layoutItem size="8">
            <lightning:card title="Free and suitable tourists" 
                            iconName="custom:custom20" 
                            class="slds-p-horizontal_medium">                
                
                <aura:if isTrue="{!and(not(empty(v.tourists)), v.openService)}">                    
                    <lightning:datatable aura:id="touristTable"
                                         data="{! v.tourists }"
                                         columns="{! v.touristColumns }"                             
                                         keyField="id"
                                         onrowselection="{! c.getSelectedName }"/>        
                    <lightning:button variant="brand" 
                                      iconName="utility:record_create" 
                                      label="Add to Trip" 
                                      title="Add to Trip" 
                                      onclick="{! c.clickCreate }" 
                                      class="slds-m-around_x-small slds-m-around_medium"/>
                </aura:if>
                
                <aura:if isTrue="{!not(and(not(empty(v.tourists)), v.openService))}">
                    <div class="slds-modal__content slds-p-around_medium slds-p-left_large">
                        <p class="slds-text-align_center slds-text-heading_medium">{!$Label.c.serviceUnavailable}</p>
                        <p class="slds-text-align_center slds-text-heading_small">{!$Label.c.allSeatsTaken}</p>
                    </div>
                </aura:if>
                
                <aura:if isTrue="{!v.showSpinner}">
                    <lightning:spinner variant="brand" size="medium" class="spins" />
                </aura:if>     
            </lightning:card>
        </lightning:layoutItem>
    </lightning:layout>
    
    <aura:if isTrue="{!v.showModal}">
        <c:ConfirmationWindow title="{!v.title}" message="{!v.message}"/>           
    </aura:if>
</aura:component>